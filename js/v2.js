const width=window.innerWidth>0?window.innerWidth:screen.width,menu=()=>{const t=document.querySelector(".overlay"),e=document.querySelector(".navegacion"),a=document.querySelector("body"),s=document.querySelectorAll(".navegacion-btn"),n=document.querySelector(".burger"),c=()=>{n.classList.toggle("clicked"),t.classList.toggle("show"),e.classList.toggle("show"),a.classList.toggle("overflow")};for(document.querySelector(".burger").addEventListener("click",c),document.querySelector(".overlay").addEventListener("click",c),i=0;i<s.length;i++)s[i].addEventListener("click",function(){r()});const r=()=>{t.classList.remove("show"),e.classList.remove("show"),n.classList.remove("clicked")}};menu();const lineYear=()=>{const t=24,e=24,a=24,s=24;let n=0,c=0;const r=d3.select(".dm-job-year-graph"),d=r.select("svg"),o={};let i;const l=d3.timeParse("%d-%b-%y"),m=i=>{const l=r.node().offsetWidth;n=l-s-e,c=600-t-a,d.attr("width",l).attr("height",600);const m="translate("+s+","+t+")",u=d.select(".dm-job-year-graph-container");u.attr("transform",m);const h=d3.line().x(t=>o.count.x(t.fecha)).y(t=>o.count.y(t.total));((t,e)=>{o.count.x.range([0,t]),o.count.y.range([e,0])})(n,c);const g=r.select(".dm-job-year-graph-container-bis"),x=g.selectAll(".line").data([i]),y=x.enter().append("path").attr("class","line").attr("stroke-width","1.5"),p=g.selectAll(".circles").data(i),f=p.enter().append("circle").attr("class","circles").attr("fill","#921d5d").attr("opacity",0).transition().duration(1800).ease(d3.easeLinear).attr("opacity",1);x.merge(y).attr("d",h),p.merge(f).attr("cx",t=>o.count.x(t.fecha)).attr("cy",t=>o.count.y(t.total)).attr("r",3),(t=>{const e=d3.axisBottom(o.count.x);t.select(".axis-x").attr("transform","translate(0,"+c+")").call(e);const a=d3.axisLeft(o.count.y).tickFormat(d3.format("d")).ticks(10).tickSizeInner(-n);t.select(".axis-y").call(a)})(u);const b=y.node().getTotalLength();y.attr("stroke-dasharray",b+" "+b).attr("stroke-dashoffset",b).transition().duration(1500).ease(d3.easeLinear).attr("stroke-dashoffset",0)};window.addEventListener("resize",()=>{m(i)}),d3.csv("csv/data-ofertas-anyo.csv",(t,e)=>{t?console.log(t):((i=e).forEach(t=>{t.fecha=l(t.fecha),t.total=+t.total}),(()=>{const t=d.select(".dm-job-year-graph-container");t.append("g").attr("class","axis axis-x"),t.append("g").attr("class","axis axis-y"),t.append("g").attr("class","dm-job-year-graph-container-bis")})(),(()=>{const t=d3.scaleTime().domain(d3.extent(i,t=>t.fecha)),e=d3.scaleLinear().domain([0,d3.max(i,t=>t.total+t.total/4)]);o.count={x:t,y:e}})(),m(i))})},barHorizontal=()=>{const t=24,e=24,a=24,s=152;let n=0,c=0;const r=d3.select(".dm-job-city-graph"),d=r.select("svg"),o={};let i;const l=d3.format(".0%"),m=t=>l(t/100),u=i=>{const l=r.node().offsetWidth;h=600,n=l-s-e,c=h-t-a,d.attr("width",l).attr("height",h);const u="translate("+s+","+t+")",g=d.select(".dm-job-city-graph-container");g.attr("transform",u),((t,e)=>{o.count.x.range([0,t]),o.count.y.range([e,0])})(n,c);const x=r.select(".dm-job-city-graph-container-bis").selectAll(".bar-horizontal").data(i),y=x.enter().append("rect").attr("class","bar-horizontal");x.merge(y).attr("x",0).attr("y",t=>o.count.y(t.ciudad)).attr("height",o.count.y.bandwidth()).transition().duration(1500).ease(d3.easePolyInOut).attr("width",t=>o.count.x(t.cantidad)),(t=>{const e=d3.axisBottom(o.count.x).tickFormat(m).tickSize(-c);t.select(".axis-x").attr("transform","translate(0,"+c+")").call(e);const a=d3.axisLeft(o.count.y);t.select(".axis-y").call(a)})(g)};window.addEventListener("resize",()=>{u(i)}),d3.csv("csv/data-ciudades-porcentaje.csv",(t,e)=>{t?console.log(t):((i=e).forEach(t=>{t.ciudad=t.ciudad,t.cantidad=+t.cantidad}),i.sort((t,e)=>t.cantidad-e.cantidad),(()=>{const t=d.select(".dm-job-city-graph-container");t.append("g").attr("class","axis axis-x"),t.append("g").attr("class","axis axis-y"),t.append("g").attr("class","dm-job-city-graph-container-bis")})(),(()=>{const t=d3.scaleLinear().domain([0,d3.max(i,t=>t.cantidad)]),e=d3.scaleBand().domain(i.map(t=>t.ciudad)).paddingInner(.2).paddingOuter(.5);o.count={x:t,y:e}})(),u(i))})},remote=()=>{const t=24,e=24,a=24,s=24;let n=0,c=0;const r=d3.select(".dm-job-remote-graph"),d=r.select("svg"),o={};let i;const l=d3.timeParse("%d-%b-%y"),m=i=>{const l=r.node().offsetWidth;n=l-s-e,c=600-t-a,d.attr("width",l).attr("height",600);const m="translate("+s+","+t+")",u=d.select(".dm-job-remote-graph-container");u.attr("transform",m);const h=d3.line().x(t=>o.count.x(t.fecha)).y(t=>o.count.y(t.total));((t,e)=>{o.count.x.range([0,t]),o.count.y.range([e,0])})(n,c);const g=r.select(".dm-job-remote-graph-container-bis"),x=g.selectAll(".lines").data([i]),y=x.enter().append("path").attr("class","lines").attr("stroke-width","1.5"),p=g.selectAll(".circles").data(i),f=p.enter().append("circle").attr("class","circles").attr("fill","#921d5d");x.merge(y).attr("d",h),p.merge(f).attr("cx",t=>o.count.x(t.fecha)).attr("cy",t=>o.count.y(t.total)).attr("r",3),(t=>{const e=d3.axisBottom(o.count.x);t.select(".axis-x").attr("transform","translate(0,"+c+")").call(e);const a=d3.axisLeft(o.count.y).tickFormat(d3.format("d")).ticks(10).tickSizeInner(-n);t.select(".axis-y").call(a)})(u)};window.addEventListener("resize",()=>{m(i)}),d3.csv("csv/data-remoto-mes.csv",(t,e)=>{t?console.log(t):((i=e).forEach(t=>{t.fecha=l(t.fecha),t.total=+t.total}),(()=>{const t=d.select(".dm-job-remote-graph-container");t.append("g").attr("class","axis axis-x"),t.append("g").attr("class","axis axis-y"),t.append("g").attr("class","dm-job-remote-graph-container-bis")})(),(()=>{const t=d3.scaleTime().domain(d3.extent(i,t=>t.fecha)),e=d3.scaleLinear().domain([0,d3.max(i,t=>t.total+t.total/4)]);o.count={x:t,y:e}})(),m(i))})};remote();const flash=()=>{const t=24,e=24,a=24,s=24;let n=0,c=0;const r=d3.select(".dm-job-flash-graph"),d=r.select("svg"),o={};let i;const l=d3.timeParse("%d-%b-%y"),m=i=>{const l=r.node().offsetWidth;n=l-s-e,c=600-t-a,d.attr("width",l).attr("height",600);const m="translate("+s+","+t+")",u=d.select(".dm-job-flash-graph-container");u.attr("transform",m);const h=d3.line().x(t=>o.count.x(t.fecha)).y(t=>o.count.y(t.total));((t,e)=>{o.count.x.range([0,t]),o.count.y.range([e,0])})(n,c);const g=r.select(".dm-job-flash-graph-container-bis").selectAll(".line").data([i]),x=g.enter().append("path").attr("class","line").attr("stroke-width","1.5");g.merge(x).attr("d",h),(t=>{const e=d3.axisBottom(o.count.x);t.select(".axis-x").attr("transform","translate(0,"+c+")").call(e);const a=d3.axisLeft(o.count.y).tickFormat(d3.format("d")).ticks(10).tickSizeInner(-n);t.select(".axis-y").call(a)})(u)};window.addEventListener("resize",()=>{m(i)}),d3.csv("csv/data-flash-mes.csv",(t,e)=>{t?console.log(t):((i=e).forEach(t=>{t.fecha=l(t.fecha),t.total=+t.total}),(()=>{const t=d.select(".dm-job-flash-graph-container");t.append("g").attr("class","axis axis-x"),t.append("g").attr("class","axis axis-y"),t.append("g").attr("class","dm-job-flash-graph-container-bis")})(),(()=>{const t=d3.scaleTime().domain(d3.extent(i,t=>t.fecha)),e=d3.scaleLinear().domain([0,d3.max(i,t=>t.total+t.total/4)]);o.count={x:t,y:e}})(),m(i))})};flash();const multipleLines=()=>{const t=48,e=24,a=24,s=24,n=960-s-e,c=220-t-a;d3.scaleOrdinal(["#9a1622","#e30613","#0080b8","#f07a36"]);let r=d3.timeParse("%x");const d=d3.scaleTime().range([0,n]),o=d3.scaleLinear().range([c,0]),i=d3.area().x(t=>d(t.fecha)).y0(c).y1(t=>o(t.cantidad)),l=d3.line().x(t=>d(t.fecha)).y(t=>o(t.cantidad));d3.csv("csv/data-line-puestos.csv",function(t){return t.cantidad=+t.cantidad,t.fecha=r(t.fecha),t},(r,m)=>{const u=d3.nest().key(t=>t.puesto).entries(m);u.forEach(function(t){t.maxPrice=d3.max(t.values,t=>t.cantidad)}),d.domain([d3.min(m,t=>t.fecha),d3.max(m,t=>t.fecha)]),o.domain([d3.min(m,t=>t.cantidad),d3.max(m,t=>t.cantidad)]);const h=d3.select(".dm-multiple-container-graph").selectAll("svg").data(u).enter().append("svg").attr("viewBox","0 0 "+(n+(s+e))+"  "+(c+(t+a))).append("g").attr("transform","translate("+s+","+t+")");h.append("g").attr("class","axis axis-x"),h.append("g").attr("class","axis axis-y");const g=d3.axisBottom(d).tickFormat(d3.timeFormat("%Y")).ticks(5),x=d3.axisLeft(o).tickFormat(d3.format("d")).ticks(5).tickSizeInner(-n);h.select(".axis-x").attr("transform","translate(0,"+c+")").call(g),h.select(".axis-y").call(x),h.append("path").attr("class","area").attr("class",t=>t.key).style("opacity",.7).attr("d",t=>i(t.values)),h.append("path").attr("class","line").attr("d",t=>l(t.values)).style("stroke","#111"),h.append("text").attr("class","multiple-legend").attr("x",16).attr("y",-10).style("text-anchor","start").text(t=>t.key)})};multipleLines();const animateDendogram=()=>{const t=function(t,e){return 120*e};anime.timeline().add({targets:"#madrid-dendogram .mdl-two",strokeDashoffset:[anime.setDashoffset,0],easing:"easeInOutSine",delay:t,duration:150}).add({targets:"#madrid-dendogram .madrid-dendogram-circle-middle",r:[0,5],easing:"easeInOutSine",delay:t,duration:150}).add({targets:"#madrid-dendogram .madrid-dendogram-text-job",opacity:[0,1],easing:"easeInOutSine",delay:t,duration:150}).add({targets:"#madrid-dendogram .mdl-three",strokeDashoffset:[anime.setDashoffset,0],easing:"easeInOutSine",delay:t,duration:150}).add({targets:"#madrid-dendogram .madrid-dendogram-circle-final",r:function(t){return t.getAttribute("mydata:id")},easing:"easeInOutSine",delay:t,duration:150}).add({targets:"#madrid-dendogram .madrid-dendogram-text-percentage",opacity:[0,1],easing:"easeInOutSine",delay:t,duration:150})},dendogram=()=>{const t=document.querySelector("#madrid-dendogram"),e=document.querySelector("#barcelona-dendogram"),a=document.querySelector("#remote-dendogram");document.querySelector(".js-dm-job-dendogram-btn-m").addEventListener("click",()=>{lunar.removeClass(t,"dendo-hide"),lunar.addClass(e,"dendo-hide"),lunar.addClass(a,"dendo-hide")}),document.querySelector(".js-dm-job-dendogram-btn-b").addEventListener("click",()=>{lunar.removeClass(e,"dendo-hide"),lunar.addClass(t,"dendo-hide"),lunar.addClass(a,"dendo-hide")}),document.querySelector(".js-dm-job-dendogram-btn-r").addEventListener("click",()=>{lunar.removeClass(a,"dendo-hide"),lunar.addClass(e,"dendo-hide"),lunar.addClass(t,"dendo-hide")})};dendogram();const scrolama=()=>{document.querySelector("#scroll").querySelectorAll(".dm-job-generic");let t=scrollama();const e=t=>{0!==t.index||t.element.classList.contains("scrollaunch")?1!==t.index||t.element.classList.contains("scrollaunch")?2!==t.index||t.element.classList.contains("scrollaunch")?3!==t.index||t.element.classList.contains("scrollaunch")?4!==t.index||t.element.classList.contains("scrollaunch")?5!==t.index||t.element.classList.contains("scrollaunch")||(flash(),t.element.classList.add("scrollaunch")):(multipleLines(),t.element.classList.add("scrollaunch")):(remote(),t.element.classList.add("scrollaunch")):(animateDendogram(),t.element.classList.add("scrollaunch")):(barHorizontal(),t.element.classList.add("scrollaunch")):(lineYear(),t.element.classList.add("scrollaunch"))};t.setup({step:".dm-job-generic",debug:!1,offset:.2}).onStepEnter(e),window.addEventListener("resize",t.resize)};scrolama();const areaStack=()=>{const t=24,e=24,a=24,s=48;let n=0,c=0;const r=d3.select(".area-stack"),d=r.select("svg"),o={};let i;const l=i=>{const l=r.node().offsetWidth;n=l-s-e,c=600-t-a,d.attr("width",l).attr("height",600);const m="translate("+s+","+t+")",u=d.select(".area-stack-container");u.attr("transform",m);const h=i.columns.slice(1),g=d3.area().x((t,e)=>o.count.x(t.data.year)).y0(t=>o.count.y(t[0])).y1(t=>o.count.y(t[1])).curve(d3.curveCardinal.tension(.6)),x=d3.stack().keys(h).order(d3.stackOrderInsideOut)(i),y=d3.scaleOrdinal().domain(h).range(["#1DACE6","#1D366A","#F24C29","#E4C3A0","#C3CED0"]);((t,e)=>{o.count.x.range([0,t]),o.count.y.range([e,0])})(n,c);const p=r.select(".area-stack-container-bis").selectAll(".area").data(x),f=p.enter().append("path").attr("class","area");p.merge(f).transition().duration(600).ease(d3.easeLinear).style("fill",t=>y(t.key)).attr("d",g),(t=>{const e=d3.axisBottom(o.count.x).tickFormat(d3.format("d")).ticks(5);t.select(".axis-x").attr("transform","translate(0,"+c+")").call(e);const a=d3.axisLeft(o.count.y).tickFormat(d3.format("d")).tickSizeInner(-n).ticks(5);t.select(".axis-y").call(a)})(u)};window.addEventListener("resize",()=>{l(i)}),d3.csv("csv/accidentes.csv",(t,e)=>{t?console.log(t):((i=e).forEach(t=>{t.year=t.year}),(()=>{const t=d.select(".area-stack-container");t.append("g").attr("class","axis axis-x"),t.append("g").attr("class","axis axis-y"),t.append("g").attr("class","area-stack-container-bis")})(),(()=>{const t=d3.scaleTime().domain(d3.extent(i,t=>t.year)),e=d3.scaleLinear().domain([0,2e3]);o.count={x:t,y:e}})(),l(i))})};areaStack();