var width=window.innerWidth>0?window.innerWidth:screen.width;function menu(){var t=document.querySelector(".overlay"),e=document.querySelector(".navegacion"),a=document.querySelector("body"),n=document.querySelectorAll(".navegacion-btn"),r=document.querySelector(".burger");function o(){r.classList.toggle("clicked"),t.classList.toggle("show"),e.classList.toggle("show"),a.classList.toggle("overflow")}for(document.querySelector(".burger").addEventListener("click",o),document.querySelector(".overlay").addEventListener("click",o),i=0;i<n.length;i++)n[i].addEventListener("click",function(){d()});function d(){t.classList.remove("show"),e.classList.remove("show"),r.classList.remove("clicked")}}var margin={top:48,right:48,bottom:48,left:48},height=(width=1e3-margin.left-margin.right,550-margin.top-margin.bottom);function jobYear(){var t,e,a,n,r,o=d3.select(".dm-job-year-graph"),d=o.append("g").classed("axisLayer",!0),i=o.append("g").classed("chartLayer",!0),s=d3.scaleTime(),c=d3.scaleLinear(),l=d3.timeParse("%d-%b-%y");function u(l){!function(l){t=document.querySelector(".dm-container-graph").clientWidth,e=document.querySelector(".dm-container-graph").clientHeight,a=t-((r={top:48,left:48,bottom:48,right:48}).left+r.right),n=e-(r.top+r.bottom),o.attr("width",t).attr("height",e),d.attr("width",t).attr("height",e),i.attr("width",a).attr("height",n).attr("transform","translate("+[r.left,r.top]+")"),s.domain(d3.extent(l,function(t){return t.fecha})).range([0,a]),c.domain([0,d3.max(l,function(t){return t.total+t.total/4})]).range([n,0])}(l),function(){var t=d3.axisLeft(c).tickSizeInner(-a).tickFormat(d3.format("d")).ticks(10),e=d.selectAll(".y").data(["dummy"]),o=e.enter().append("g").attr("class","axis y");e.merge(o).attr("transform","translate("+[r.left,r.top]+")").call(t);var i=d3.axisBottom(s),l=d.selectAll(".x").data(["dummy"]),u=l.enter().append("g").attr("class","axis x");l.merge(u).attr("transform","translate("+[r.left,n+r.top]+")").call(i)}(),function(e){o.append("text").attr("class","legend").attr("transform","rotate(-90)").attr("y","1em").attr("x","-15em").style("text-anchor","end").text("Número de ofertas");var a=d3.line().x(function(t){return s(t.fecha)}).y(function(t){return c(t.total)}),n=i.selectAll(".line").data([e]),r=n.enter().append("path").attr("class","line").attr("stroke-width","1.5");n.merge(r).attr("d",a);var d=r.node().getTotalLength();r.attr("stroke-dasharray",d+" "+d).attr("stroke-dashoffset",d).transition().duration(2500).ease(d3.easeLinear).attr("stroke-dashoffset",0),i.selectAll(".circles").data(e).enter().append("circle").attr("cx",function(t){return s(t.fecha)}).attr("cy",function(t){return c(t.total)}).attr("class","circles").attr("r",3),t>767&&setTimeout(function(){o.selectAll("dot").attr("opacity","1");var t=[{note:{title:"Primera oferta de UX: 1/10/09",wrap:430,align:"middle"},y:540,x:157,dy:-350,dx:0},{note:{title:"Primera oferta de Angular: 3/2/14",wrap:430,align:"middle"},y:540,x:600,dy:-330,dx:0},{note:{title:"Primera oferta de React: 10/2/16",wrap:430,align:"middle"},y:540,x:792,dy:-390,dx:0}].map(function(t){return t.note=Object.assign({},t.note),t.subject={radius:6},t});window.makeAnnotations=d3.annotation().annotations(t).type(d3.annotationCalloutCircle).accessors({x:function t(e){return t(e.fecha)},y:function t(e){return t(e.total)}}).accessorsInverse({fecha:function(t){return s.invert(t.x)},total:function(t){return c.invert(t.y)}}).on("subjectover",function(t){t.type.a.selectAll("g.annotation-connector, g.annotation-note").classed("hidden",!1)}).on("subjectout",function(t){t.type.a.selectAll("g.annotation-connector, g.annotation-note").classed("hidden",!0)}),o.append("g").attr("class","annotation-test").call(makeAnnotations),o.selectAll("g.annotation-connector, g.annotation-note").classed("hidden",!0)},1e3)}(l)}d3.csv("csv/data-ofertas-anyo.csv",function(t){return t.fecha=l(t.fecha),t.total=+t.total,t},function(t){u(t),function(t){var e;window.addEventListener("resize",function(a){!1!==e&&clearTimeout(e),e=setTimeout(function(){u(t)})})}(t)})}function centralizame(){var t=50,e=50,a=200,n=d3.select(".dm-job-city-graph").attr("class","dm-job-city-chart").append("g").attr("transform","translate("+(a-e)+","+t+")"),r=d3.scaleLinear().range([0,width]),o=d3.scaleBand().range([height,0]),d=d3.format(".0%"),i=d3.axisBottom(r).tickSize(-height).tickFormat(function(t){return d(t/100)}).ticks(10),s=d3.axisLeft(o),c=d3.select(".dm-job-city .dm-container-graph").append("div").attr("class","tooltip-container").style("opacity",0);d3.csv("csv/data-ciudades-porcentaje.csv",function(t,e){e.forEach(function(t){t.ciudad=t.ciudad,t.cantidad=+t.cantidad}),e.sort(function(t,e){return t.cantidad-e.cantidad}),r.domain([0,d3.max(e,function(t){return t.cantidad+t.cantidad/4})]),o.domain(e.map(function(t){return t.ciudad})).paddingInner(.2).paddingOuter(.5),n.append("text").attr("class","legend").attr("y","77%").attr("x","50%").style("text-anchor","end").text("Porcentaje de ofertas"),n.append("g").attr("class","xAxis").attr("transform","translate(0,"+height+")").call(i).append("text").attr("class","label").attr("transform","translate("+width+",0)").attr("y",-5).style("text-anchor","end").text("Frequency"),n.append("g").attr("class","yAxis").call(s),n.selectAll(".bar").data(e).enter().append("rect").attr("class","bar").attr("x",0).attr("height",o.bandwidth()).attr("y",function(t){return o(t.ciudad)}).on("mouseover",function(t){c.transition().duration(300).style("opacity",1),c.html('<p class="tooltip-centralizame">Ofertas de trabajo en <span class="tooltip-contralizame-ciudad">'+t.ciudad+" </span>"+t.ofertas+"<p/>")}).transition().duration(1500).ease(d3.easePolyInOut).attr("width",function(t){return r(t.cantidad)})})}function remote(){var t,e,a,n,r,o=d3.select(".dm-job-remote-graph"),d=o.append("g").classed("axisLayer",!0),i=o.append("g").classed("chartLayer",!0),s=d3.scaleTime(),c=d3.scaleLinear(),l=d3.timeParse("%d-%b-%y");function u(l){!function(l){t=document.querySelector(".dm-container-graph").clientWidth,e=document.querySelector(".dm-container-graph").clientHeight,a=t-((r={top:48,left:48,bottom:48,right:48}).left+r.right),n=e-(r.top+r.bottom),o.attr("width",t).attr("height",e),d.attr("width",t).attr("height",e),i.attr("width",a).attr("height",n).attr("transform","translate("+[r.left,r.top]+")"),s.domain(d3.extent(l,function(t){return t.fecha})).range([0,a]),c.domain([0,d3.max(l,function(t){return t.total+t.total/4})]).range([n,0])}(l),function(){var t=d3.axisLeft(c).tickSizeInner(-a).tickFormat(d3.format("d")).ticks(10),e=d.selectAll(".y").data(["dummy"]),o=e.enter().append("g").attr("class","axis y");e.merge(o).attr("transform","translate("+[r.left,r.top]+")").call(t);var i=d3.axisBottom(s),l=d.selectAll(".x").data(["dummy"]),u=l.enter().append("g").attr("class","axis x");l.merge(u).attr("transform","translate("+[r.left,n+r.top]+")").call(i)}(),function(t){o.append("text").attr("class","legend").attr("y","5em").attr("x","120px").style("text-anchor","end").text("Número de ofertas");var e=d3.line().x(function(t){return s(t.fecha)}).y(function(t){return c(t.total)}),a=i.selectAll(".lines").data([t]),n=a.enter().append("path").attr("class","lines").attr("stroke-width","1.5");a.merge(n).attr("d",e);var r=n.node().getTotalLength();n.attr("stroke-dasharray",r+" "+r).attr("stroke-dashoffset",r).transition().duration(1500).ease(d3.easeLinear).attr("stroke-dashoffset",0),i.selectAll(".circles").data(t).enter().append("circle").attr("cx",function(t){return s(t.fecha)}).attr("cy",function(t){return c(t.total)}).attr("class","circles").attr("r",3)}(l)}d3.csv("csv/data-remoto-mes.csv",function(t){return t.fecha=l(t.fecha),t.total=+t.total,t},function(t){u(t),function(t){var e;window.addEventListener("resize",function(a){!1!==e&&clearTimeout(e),e=setTimeout(function(){u(t)})})}(t)})}function multiple(){var t=d3.select(".dm-job-multiple-graph").attr("class","dm-job-multiple-chart").append("g").attr("transform","translate("+margin.left+","+margin.top+")"),e=d3.timeParse("%Y"),a=d3.scaleTime().range([0,width]),n=d3.scaleLinear().range([height,0]),r=(d3.bisector(function(t){return t.fecha}).left,d3.line().x(function(t){return a(t.fecha)}).y(function(t){return n(t.cantidad)})),o=d3.axisLeft(n).tickSize(-width).tickFormat(d3.format("d")).ticks(10);d3.csv("csv/data-line-puestos.csv",function(d,i){i.forEach(function(t){t.fecha=e(t.fecha),t.cantidad=+t.cantidad}),a.domain(d3.extent(i,function(t){return t.fecha})),n.domain([0,d3.max(i,function(t){return t.cantidad+t.cantidad/4})]);var s=d3.nest().key(function(t){return t.puesto}).entries(i),c=d3.scaleOrdinal(["#b114c0","#9C1B12","#759CA7","#CEBAC6","#2D3065"]);t.append("g").attr("class","focus").style("display","none");s.forEach(function(e){t.append("path").attr("class","line "+e.key).style("stroke",function(){return e.color=c(e.key)}).attr("d",r(e.values))}),t.append("text").attr("class","legend").attr("y","0em").attr("x","80px").style("text-anchor","end").text("Número de ofertas"),t.append("g").attr("class","xAxis").attr("transform","translate(0,"+height+")").call(d3.axisBottom(a)),t.append("g").attr("class","yAxis").call(o),d3.selectAll(".line").each(function(t,e){var a=d3.select(".line").node().getTotalLength();d3.selectAll(".line").attr("stroke-dasharray",a+" "+a).attr("stroke-dashoffset",a).transition().duration(1500).delay(200*e).ease(d3.easeExpIn).attr("stroke-dashoffset",0).style("stroke-width",2)});var l=t.append("g").attr("class","mouse-over-effects");l.append("path").attr("class","mouse-line");var u=document.getElementsByClassName("line"),m=l.selectAll(".mouse-per-line").data(s).enter().append("g").attr("class","mouse-per-line");m.append("circle").attr("r",7).style("fill","none").attr("stroke",function(t,e){return c(e)}).style("stroke-width","2px").style("opacity","0"),m.append("text").attr("class","lengend-circle-text").attr("transform","translate(10,3)"),l.append("svg:rect").attr("width",width).attr("height",height).attr("fill","none").attr("pointer-events","all").on("mouseout",function(){d3.select(".mouse-line").style("opacity","0"),d3.selectAll(".mouse-per-line circle").style("opacity","0"),d3.selectAll(".mouse-per-line text").style("opacity","0")}).on("mouseover",function(){d3.select(".mouse-line").style("opacity","1"),d3.selectAll(".mouse-per-line circle").style("opacity","1"),d3.selectAll(".mouse-per-line text").style("opacity","1")}).on("mousemove",function(){var t=d3.mouse(this);d3.select(".mouse-line").attr("d",function(){var e="M"+t[0]+","+height;return e+=" "+t[0]+",0"}),d3.selectAll(".mouse-per-line").attr("transform",function(e,r){var o=a.invert(t[0]),d=d3.bisector(function(t){return t.fecha}).right;idx=d(e.values,o);for(var i=0,s=u[r].getTotalLength(),c=null;c=Math.floor((i+s)/2),pos=u[r].getPointAtLength(c),c!==s&&c!==i||pos.x===t[0];)if(pos.x>t[0])s=c;else{if(!(pos.x<t[0]))break;i=c}return d3.select(this).select("text").text(n.invert(pos.y).toFixed(0)),"translate("+t[0]+","+pos.y+")"})})})}function flashJob(){var t,e,a,n,r,o=d3.select(".dm-job-flash-graph"),d=o.append("g").classed("axisLayer",!0),i=o.append("g").classed("chartLayer",!0),s=d3.scaleTime(),c=d3.scaleLinear(),l=d3.timeParse("%d-%b-%y");function u(l){!function(l){t=document.querySelector(".dm-container-graph").clientWidth,e=document.querySelector(".dm-container-graph").clientHeight,a=t-((r={top:48,left:48,bottom:48,right:48}).left+r.right),n=e-(r.top+r.bottom),o.attr("width",t).attr("height",e),d.attr("width",t).attr("height",e),i.attr("width",a).attr("height",n).attr("transform","translate("+[r.left,r.top]+")"),s.domain(d3.extent(l,function(t){return t.fecha})).range([0,a]),c.domain([0,d3.max(l,function(t){return t.total+t.total/4})]).range([n,0])}(l),function(){var t=d3.axisLeft(c).tickSizeInner(-a).tickFormat(d3.format("d")).ticks(10),e=d.selectAll(".y").data(["dummy"]),o=e.enter().append("g").attr("class","axis y");e.merge(o).attr("transform","translate("+[r.left,r.top]+")").call(t);var i=d3.axisBottom(s),l=d.selectAll(".x").data(["dummy"]),u=l.enter().append("g").attr("class","axis x");l.merge(u).attr("transform","translate("+[r.left,n+r.top]+")").call(i)}(),function(t){var e=d3.line().x(function(t){return s(t.fecha)}).y(function(t){return c(t.total)}),a=i.selectAll(".line").data([t]),n=a.enter().append("path").attr("class","line").attr("stroke-width","1.5");a.merge(n).attr("d",e),o.append("text").attr("class","legend").attr("y","3em").attr("x","120px").style("text-anchor","end").text("Número de ofertas")}(l)}d3.csv("csv/data-flash-mes.csv",function(t){return t.fecha=l(t.fecha),t.total=+t.total,t},function(t){u(t),function(t){var e;window.addEventListener("resize",function(a){!1!==e&&clearTimeout(e),e=setTimeout(function(){u(t)})})}(t)})}function animateDendogram(){var t=function(t,e){return 120*e};anime.timeline().add({targets:"#madrid-dendogram .mdl-two",strokeDashoffset:[anime.setDashoffset,0],easing:"easeInOutSine",delay:t,duration:150}).add({targets:"#madrid-dendogram .madrid-dendogram-circle-middle",r:[0,5],easing:"easeInOutSine",delay:t,duration:150}).add({targets:"#madrid-dendogram .madrid-dendogram-text-job",opacity:[0,1],easing:"easeInOutSine",delay:t,duration:150}).add({targets:"#madrid-dendogram .mdl-three",strokeDashoffset:[anime.setDashoffset,0],easing:"easeInOutSine",delay:t,duration:150}).add({targets:"#madrid-dendogram .madrid-dendogram-circle-final",r:function(t){return t.getAttribute("mydata:id")},easing:"easeInOutSine",delay:t,duration:150}).add({targets:"#madrid-dendogram .madrid-dendogram-text-percentage",opacity:[0,1],easing:"easeInOutSine",delay:t,duration:150})}function dendogram(){var t=document.querySelector("#madrid-dendogram"),e=document.querySelector("#barcelona-dendogram"),a=document.querySelector("#remote-dendogram");document.querySelector(".js-dm-job-dendogram-btn-m").addEventListener("click",function(){lunar.removeClass(t,"dendo-hide"),lunar.addClass(e,"dendo-hide"),lunar.addClass(a,"dendo-hide")}),document.querySelector(".js-dm-job-dendogram-btn-b").addEventListener("click",function(){lunar.removeClass(e,"dendo-hide"),lunar.addClass(t,"dendo-hide"),lunar.addClass(a,"dendo-hide")}),document.querySelector(".js-dm-job-dendogram-btn-r").addEventListener("click",function(){lunar.removeClass(a,"dendo-hide"),lunar.addClass(e,"dendo-hide"),lunar.addClass(t,"dendo-hide")})}function scrolama(){document.querySelector("#scroll").querySelectorAll(".dm-job-generic");var t=scrollama();function e(t){0!==t.index||t.element.classList.contains("scrollaunch")?1!==t.index||t.element.classList.contains("scrollaunch")?2!==t.index||t.element.classList.contains("scrollaunch")?3!==t.index||t.element.classList.contains("scrollaunch")?4!==t.index||t.element.classList.contains("scrollaunch")?5!==t.index||t.element.classList.contains("scrollaunch")||(flashJob(),t.element.classList.add("scrollaunch")):(multiple(),t.element.classList.add("scrollaunch")):(remote(),t.element.classList.add("scrollaunch")):(animateDendogram(),t.element.classList.add("scrollaunch")):(centralizame(),t.element.classList.add("scrollaunch")):(jobYear(),t.element.classList.add("scrollaunch"))}t.setup({step:".dm-job-generic",debug:!1,offset:.2}).onStepEnter(e),window.addEventListener("resize",t.resize)}dendogram(),menu(),scrolama();